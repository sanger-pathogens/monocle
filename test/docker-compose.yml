version: '3'
services:
    cypress:
        image: "cypress/included:3.8.1"
        environment:
            - CYPRESS_BASE_URL=http://ui:3001/
        working_dir: /e2e
        volumes:
            - ./:/e2e
        depends_on:
            - ui
    ui:
        build:
            context: ../ui
        ports:
            - "3001:80"
        volumes:
            - ../ui/settings.test.js:/usr/share/nginx/html/settings.js
            - ../ui/nginx.prod.conf:/etc/nginx/conf.d/default.conf
        depends_on:
            - api
    api:
        build:
            context: ../api
        ports:
            - "8001:80"